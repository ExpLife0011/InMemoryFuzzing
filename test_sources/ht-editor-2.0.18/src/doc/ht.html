<html lang="en">
<head>
<title>HT Editor Documentation</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="HT Editor Documentation">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<h1 class="settitle">HT Editor Documentation</h1>
<div class="node">
<a name="Top"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h3 class="unnumberedsec">HT Editor</h3>

<p class="noindent">This is HT 2.0.18;
Have fun<small class="dots">...</small>

<ul class="menu">
<li><a accesskey="1" href="#About">About</a>
<li><a accesskey="2" href="#Key-bindings">Key bindings</a>
<li><a accesskey="3" href="#Features">Features</a>
<li><a accesskey="4" href="#Authors">Authors</a>
<li><a accesskey="5" href="#Where-to-download_003f">Where to download?</a>
</ul>

<div class="node">
<a name="About"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h3 class="unnumberedsec">About</h3>

<p class="noindent">This program is a file viewer, editor and analyzer for text, binary, and (especially) executable files.

   <blockquote>
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License version 2 as published by
the Free Software Foundation.

   <p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

   <p>You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111 USA
</blockquote>

<div class="node">
<a name="Key-bindings"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h3 class="unnumberedsec">Key bindings</h3>

     <ul>
<li>General key bindings

     <p><table summary=""><tr align="left"><td valign="top" width="25%">Return
</td><td valign="top" width="75%">follow link (if applicable)
<br></td></tr><tr align="left"><td valign="top" width="25%">Backspace
</td><td valign="top" width="75%">undo &ldquo;follow link&rdquo;
<br></td></tr><tr align="left"><td valign="top" width="25%">Space/F6
</td><td valign="top" width="75%">choose view mode
<br></td></tr><tr align="left"><td valign="top" width="25%">Alt+[1-9]
</td><td valign="top" width="75%">select window
<br></td></tr><tr align="left"><td valign="top" width="25%">Alt+0
</td><td valign="top" width="75%">select window list
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+Left/Right
</td><td valign="top" width="75%">scroll left/right
<br></td></tr><tr align="left"><td valign="top" width="25%">Cursor keys
</td><td valign="top" width="75%">move around
<br></td></tr><tr align="left"><td valign="top" width="25%">Page Up/Down
</td><td valign="top" width="75%">next/prev page
<br></td></tr><tr align="left"><td valign="top" width="25%">Alt+S
</td><td valign="top" width="75%">toggle select
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+Ins/Alt+C
</td><td valign="top" width="75%">copy
<br></td></tr><tr align="left"><td valign="top" width="25%">Shift+Ins/Alt+V
</td><td valign="top" width="75%">insert
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+Del/Alt+D
</td><td valign="top" width="75%">delete
<br></td></tr><tr align="left"><td valign="top" width="25%">Shift+Del/Alt+X
</td><td valign="top" width="75%">cut
     <br></td></tr></table>

     <li>Window key bindings

     <p><table summary=""><tr align="left"><td valign="top" width="25%">Alt+F3/Ctrl+W
</td><td valign="top" width="75%">close window
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+F5
</td><td valign="top" width="75%">resize/move mode
<br></td></tr><tr align="left"><td valign="top" width="25%"></td><td valign="top" width="75%">(in resize/move mode only:)
<br></td></tr><tr align="left"><td valign="top" width="25%">Space
</td><td valign="top" width="75%">toggle resize/move mode
<br></td></tr><tr align="left"><td valign="top" width="25%">Cursor keys
</td><td valign="top" width="75%">resize/move window
<br></td></tr><tr align="left"><td valign="top" width="25%">Escape/Return/Ctrl+F5
</td><td valign="top" width="75%">leave resize/move mode
     <br></td></tr></table>

     <li>Analyser key bindings

     <p><table summary=""><tr align="left"><td valign="top" width="25%">c
</td><td valign="top" width="75%">continue code analysis at cursor
<br></td></tr><tr align="left"><td valign="top" width="25%">f
</td><td valign="top" width="75%">follow dword ptr at address
<br></td></tr><tr align="left"><td valign="top" width="25%">n
</td><td valign="top" width="75%">name current address
(empty string to delete)
<br></td></tr><tr align="left"><td valign="top" width="25%">x
</td><td valign="top" width="75%">show xrefs (search for xrefs)
<br></td></tr><tr align="left"><td valign="top" width="25%">#
</td><td valign="top" width="75%">edit comments
<br></td></tr><tr align="left"><td valign="top" width="25%">s
</td><td valign="top" width="75%">define a string
<br></td></tr><tr align="left"><td valign="top" width="25%">i
</td><td valign="top" width="75%">define an integer (32bit)
<br></td></tr><tr align="left"><td valign="top" width="25%">h
</td><td valign="top" width="75%">define a halfword (16bit)
<br></td></tr><tr align="left"><td valign="top" width="25%">b
</td><td valign="top" width="75%">define a byte (8bit)
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+A
</td><td valign="top" width="75%">call assembler
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+F
</td><td valign="top" width="75%">goto start of current function<br>
(indicated in the 2nd line)
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+L
</td><td valign="top" width="75%">goto previous label
<br></td></tr><tr align="left"><td valign="top" width="25%">Ctrl+T
</td><td valign="top" width="75%">show recursive function references

     <br></td></tr></table>

</ul>

   <pre class="sp">

</pre>
Note: Some keys don't work in HT-posix. Try using Escape
instead of Control or something...

<div class="node">
<a name="Authors"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h3 class="unnumberedsec">Authors</h3>

     <ul>
<li>Stefan Weyergraf

     <li>Sebastian Biallas <a href="mailto:sb@biallas.net">sb@biallas.net</a>
</ul>

<div class="node">
<a name="Features"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h3 class="unnumberedsec">Features</h3>

<p>HT contains some very advanced and useful features, which you
should carefully inspect:

<ul class="menu">
<li><a accesskey="1" href="#General-features">General features</a>
<li><a accesskey="2" href="#Configuration-files">Configuration files</a>
<li><a accesskey="3" href="#Clipboard">Clipboard</a>
<li><a accesskey="4" href="#Global-history">Global history</a>
<li><a accesskey="5" href="#Expression-evaluation">Expression evaluation</a>
<li><a accesskey="6" href="#Block-operations">Block operations</a>
<li><a accesskey="7" href="#Search-and-its-different-modes">Search and its different modes</a>
<li><a accesskey="8" href="#Command-line-options">Command line options</a>
</ul>

<div class="node">
<a name="General-features"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">General features</h3>

     <ol type=1 start=1>
<li>Supported file formats
          <ul>
<li>common object file format (COFF/XCOFF32)
               <ul>
<li>- header <br>
- image with code/data analyser (x86)
</ul>
          <li>executable and linkable format (ELF)
               <ul>
<li>- header <br>
- section headers <br>
- program headers <br>
- symbol tables <br>
- image with code/data analyser (x86, AMD64, IA-64, Alpha, PowerPC, ARM) and relocations
</ul>
          <li>linear executables (LE)
               <ul>
<li>- header <br>
- VxD descriptor <br>
- object table <br>
- page table <br>
- image with code/data analyser (x86) <br>
- auto-relocation layer (only internal refs for now)
</ul>
          <li>standard dos executables (MZ)
               <ul>
<li>- header <br>
- relocations <br>
- image (disassembly only)
</ul>
          <li>new executables (NE)
               <ul>
<li>- header <br>
- segments <br>
- names <br>
- entrypoints <br>
- image with code/data analyser (x86) <br>
- auto-relocation layer (pretty complete)
</ul>
          <li>portable executables (PE32, PE64)
               <ul>
<li>- header <br>
- import section <br>
- delay-import section <br>
- export section <br>
- resources <br>
- image with code/data analyser (x86, AMD64, PowerPC, IA-64, Alpha, ARM) <br>
- preliminary support for .net executables
</ul>
          <li>java class files (CLASS)
               <ul>
<li>- header <br>
- image with code/data analyser (java bytecode disassembler)
</ul>
          <li>Mach exe/link format (MachO)
               <ul>
<li>- header <br>
- image with code/data analyser (x86, AMD64, PowerPC, ARM) <br>
</ul>
          <li>X-Box executable (XBE)
               <ul>
<li>- header <br>
- imports <br>
- image with code/data analyser (x86) <br>
</ul>
          <li>Flat (FLT)
               <ul>
<li>- header <br>
- image with data analyser (no disassembler yet) <br>
</ul>
          <li>PowerPC executable format (PEF)
               <ul>
<li>- header <br>
- imports
- image with code/data analyser (PowerPC) <br>
</ul>
          <li>Still some to be implemented (M$-OBJ, ARCH, LX)
</ul>
     <li>Code &amp; Data Analyser
          <ul>
- finds branch sources and destinations recursively <br>
- finds procedure entries <br>
- creates labels based on this information <br>
- creates xref information <br>
- allows to interactively analyse unexplored code (press 'c') <br>
- allows to create/rename/delete labels (press 'n') <br>
- allows to create/edit comments (press '#')
</ul>
     <li>Target systems
          <ul>
- DJGPP <br>
- GNU/Linux <br>
- FreeBSD <br>
- Win32
</ul>
     </ol>

<div class="node">
<a name="Configuration-files"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Configuration files</h3>

<h4 class="unnumberedsubsec">Global configuration</h4>

<p>HT automatically creates a file to store its configuration. 
It is called <samp><span class="file">~/.htcfg2</span></samp> on Unices and <samp><span class="file">ht.cfg2</span></samp> (where
ht.exe resides) on Windows. More specifically it contains HT's registry
and the See <a href="#Global-history">Global history</a>.

<h4 class="unnumberedsubsec">Per file configuration</h4>

<p>The analyser (for analysable files) will be stored in an extra file called
<samp><span class="file">FILENAME.htcfg</span></samp>, where FILENAME is the analysed file. This file contains
all information to restore the complete state of the analyser.

<div class="node">
<a name="Clipboard"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Clipboard</h3>

<p>All open files and dialogs use the common clipboard, where all
copied and cut text or binary data is stored. Clipboard operations are
normally binary safe, that means you can copy some binary data out of a
file and paste it into an input line. Exceptions are only the \0 character
(binary null), it will be converted to a space in places where it would not
make sense (e.g. file open).

   <p>Although the clipboard won't be saved between different HT sessions
(ie. you will loose it when exiting HT), you can either save and load it
or part of it manually (via Edit-&gt;paste into/copy from file) or rely on
the input lines' See <a href="#Global-history">history</a>, which is stored and
retrieved from the config file automatically.

<div class="node">
<a name="Global-history"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Global history</h3>

<p>HTs history system is global, which means that you can use it for all open
files. Histories are also grouped by their context. I.e. file-related and
regex-search-related dialogs have their own history (who would want to
open "[0-9][0-9a-z]+" anyway?).

   <p>History entries are stored within the See <a href="#Configuration-files">Configuration files</a>, so they
can be reused when you relaunch.

   <p>You can delete a history entry by pressing DEL inside the history popup.

<div class="node">
<a name="Expression-evaluation"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Expression evaluation</h3>

<p>HT contains a very powerful expression evaluator which is used in all dialogs
where expressions are expected. These are mainly blockoperation, goto,
search and of course evaluate itself (Edit-&gt;Evaluate).

   <p>You can use all standard math operators (+ - / * % **), logical operators
(! &amp;&amp; || ^^), relational operators (== != &lt; &gt; &lt;= &gt;=),
bit operators (~ &amp; | ^), string operators (. for concatenation),
parenthesis, the ternary operator (a?b:c), functions and symbols
(both depending on context).

   <p>The evaluator uses integer, string and float types depending on context. You
can always convert a result via the <code>int()</code>, <code>string()</code> and <code>float()</code> functions
to appropriate type. Try Edit-&gt;Evaluate to see how it works<small class="dots">...</small>

<h4 class="unnumberedsubsec">Functions and symbols</h4>

<p>You can always use the standard built-in math (<code>round</code>, <code>sin</code>, <code>random</code>, etc.) and
string (<code>strcmp</code>, <code>strchr</code>, <code>sprintf</code>, etc.) functions, they work more or less like the corresponding
C functions (actually they ARE more or less wrappers for them); see <samp><span class="file">eval/eval.y</span></samp> for
details (sorry but a detailed help would get outdated rather soon).

   <p>The symbol _ always refers to the last result.

   <p>When using See <a href="#Block-operations">Block operations</a>, or searching you have some
context depending functions and symbols; see these sections for explanation.

<div class="node">
<a name="Block-operations"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Block operations</h3>

<p>Block operation (Blockop) is a very powerful tool to perform modifications
on binary files. It is available in hex viewer only.

   <p>Blockop takes four parameters: <var>start</var>, <var>end</var>, <var>mode</var> and
<var>expression</var>. Blockop works as follows:

     <ul>
<li>START: Start at the offset specified by <var>start</var>
<li>REPEAT: Evaluate <var>expression</var> and store n bytes (1 - byte, 2 - word,
4 - dword, variable - string) at the current offset. Increment current offset
by n. Stop if <var>end</var> has been reached. 
</ul>

<p class="noindent">Special variables/functions that can be used in <var>expression</var>:

     <dl>
<dt><code>readbyte(ofs)</code><dd>read a byte from offset <var>ofs</var>, returns a number
<br><dt><code>readstring(ofs, size)</code><dd>read <var>size</var> bytes from offset <var>ofs</var>, returns a string
<br><dt><code>i</code><dd>contains the iteration count/index starting with 0
<br><dt><code>o</code><dd>contains the current offset
</dl>

<div class="node">
<a name="Search-and-its-different-modes"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Search and its different modes</h3>

<p>The search function is one of the most advanced functions of HT. 
It is invoked through F7, Shift-F7 continues a search from cursor. 
Depending on context (ie. file type and mode) the following modes are enabled:

<h4 class="unnumberedsubsec">bin: ASCII / Hex</h4>

<p>Enter an exact search string either via ascii characters or via hexadecimal
interpretation. This is the fastest search mode. You may specify a
case-insensitive search.

<h4 class="unnumberedsubsec">bin: eval str</h4>

<p>Enter an expression, it will be evaluated ONCE (difference to the 4th mode),
and HT will then search for the result-string. This is pretty useful when
searching for intermixed text and control-chars/binary, e.g. <code>"hello world\n\0"</code>

<h4 class="unnumberedsubsec">display: regex</h4>

<p>As the prefix indicates, this search doesn't search in the binary file but
in the display on screen. HT searches for a regular expression so this can
be very powerful, e.g. in PE/Image you can search for <code>(add|sub).+?,\ [78]$</code>. 
This will find all add or sub instructions with second parameter 7 or 8.

<h4 class="unnumberedsubsec">expr nonzero</h4>

<p>This is the slowest but also most advanced search mode. Enter an expression
and the search stops if this expression evaluates to non-zero (it will be
evaluated on every byte). In this mode there are two predefined symbols
and some functions: <var>i</var> is always the number of current iteration and
<var>o</var> stands for the current offset in file. With the functions <code>readbyte(ofs)</code>
and <code>readstring(ofs, size)</code> you access the file's content.

   <p>It's easier to understand this with examples:

     <ol type=1 start=1>
<li>Searching for patterns:

          <ol type=a start=1>
<li>Enter <code>readbyte(o) == readbyte(o+1)</code><br>
This will search for two equal bytes ("AA", "55", "!!", etc.). 
<li>Enter <code>(readbyte(o) == readbyte(o+1)+1) &amp;&amp; ((readbyte(o)==readbyte(o+2)+2)</code><br>
This will search for three ascending bytes ("ABC", "123", etc).
          </ol>

     <li>Search with special functions:

     <p>With HT you can easily detect the RSA key in the <samp><span class="file">ADVAPI32.DLL</span></samp>:
Search for <code>entropy(readstring(o, 64)) &gt; 82</code> in expr!=0 mode, and you will
find it very quickly. How does it work? <code>readstring(o, 64)</code> reads a 64 byte string
from current offset and entropy calculates the entropy ("randomness") of a string (result is 0..100). 
So the search stops if a entropy greater than 82% (guessed value)
is encountered, which normally indicates packed or encryted data.

     <p>Note: the <code>entropy()</code> function is not the best of its kind, if you know of a better
one please let us know!

        </ol>

<div class="node">
<a name="Command-line-options"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Features">Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Features">Features</a>

</div>

<h3 class="unnumberedsec">Command line options</h3>

<p><table summary="">
<tr align="left"><td valign="top" width="10%"><code>--</code>
</td><td valign="top" width="20%">

<p></td><td valign="top" width="70%">
treat all additional parameters as file names

<p><br></td></tr><tr align="left"><td valign="top" width="10%"><code>-v</code>
</td><td valign="top" width="20%">
<code>--version</code>
</td><td valign="top" width="70%">
show version and copyright on console

<p><br></td></tr><tr align="left"><td valign="top" width="10%"><code>-h</code>
</td><td valign="top" width="20%">
<code>--help</code>
</td><td valign="top" width="70%">
show help

<p><br></td></tr><tr align="left"><td valign="top" width="10%"><code>-t</code>
</td><td valign="top" width="20%">
<code>--text</code>
</td><td valign="top" width="70%">
load file(s) in text editor mode

<p><br></td></tr><tr align="left"><td valign="top" width="10%"><code>-b</code>
</td><td valign="top" width="20%">
<code>--bin</code>
</td><td valign="top" width="70%">
load file(s) in hex editor mode

<p><br></td></tr><tr align="left"><td valign="top" width="10%"><code>-a</code>
</td><td valign="top" width="20%">
<code>--auto</code>
</td><td valign="top" width="70%">
try to guess file type
<br></td></tr></table>

<div class="node">
<a name="Where-to-download%3f"></a>
<a name="Where-to-download_003f"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h3 class="unnumberedsec">Where to download?</h3>

<p class="noindent">The HT homepage is at
<a href="http://hte.sourceforge.net">http://hte.sourceforge.net</a>

<p class="noindent">Downloads are available from the 'download' section. 
Please also take a look at
<a href="http://sourceforge.net/projects/hte">http://sourceforge.net/projects/hte</a>

</body></html>

